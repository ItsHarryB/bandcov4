---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import CategoryFilters from "../components/CategoryFilters.tsx";
import "../styles/blog.css";

const pageTitle = "Website Development Log";

// Get all blog posts and sort by pubDate descending
const allPosts = (await getCollection("blog"))
  .filter((post) => post.data.pubDate)
  .sort(
    (a, b) =>
      new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
  );

// Extract unique categories
const categories = Array.from(
  new Set(
    allPosts.map((p) => p.data.category).filter((cat): cat is string => Boolean(cat))
  )
);
---
<BaseLayout>
  <div class="page-center">
    <h1>Blog</h1>
  </div>
  <h2>{pageTitle}</h2>
<CategoryFilters client:load categories={categories} />
  <!-- React Island handles category filtering and post cards -->
</BaseLayout>
