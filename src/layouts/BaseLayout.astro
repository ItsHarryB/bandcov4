---
import '@fontsource-variable/raleway'; // variable font, includes all weights
import { Image } from 'astro:assets';
import Footer from "../components/Footer.jsx";
import "../styles/global.css";

// Import the logo from src/assets
import logo from '../assets/favicon.png';
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Brighton and Co</title>
    <link rel="icon" href="/favicon.png" type="image/png" />
  </head>
  <body>
    <header class="site-header">
      <div class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
        <span class="line line1"></span>
        <span class="line line2"></span>
        <span class="line line3"></span>
      </div>

      <div class="site-title">
        <a href="/" class="site-logo-link">
          <Image 
            src={logo} 
            alt="Site Logo" 
            width={40}
            height={40}
            densities={[1, 2, 3]}
            quality={100}
            format="png"
            loading="eager"
            decoding="sync"
          />
          <span>Brighton and Co</span>
        </a>
      </div>

      <nav class="nav-links" id="nav" aria-label="Main navigation">
        <a href="/">Home</a>
        <a href="/enquiries/">Enquiries</a>
        <a href="/about-me/">About Me</a>
        <a href="/blog/">Blog</a>
        <a href="/photography/">Photography</a>
        <a href="/links/">Links</a>
      </nav>

      <div class="nav-overlay" id="nav-overlay"></div>
    </header>

    <div class="page-wrapper">
      <main class="layout-content">
        <slot />
      </main>

      <Footer client:load />
    </div>

    <script type="module">
      document.addEventListener("DOMContentLoaded", () => {
        const hamburger = document.getElementById("hamburger");
        const nav = document.getElementById("nav");
        const navOverlay = document.getElementById("nav-overlay");
        const themeToggle = document.getElementById("theme-toggle");
        const themeIcon = themeToggle?.querySelector(".theme-icon");

        // Hamburger toggle
        if (hamburger && nav && navOverlay) {
          hamburger.addEventListener("click", () => {
            nav.classList.toggle("expanded");
            hamburger.classList.toggle("active");
            navOverlay.classList.toggle("active");
          });

          navOverlay.addEventListener("click", () => {
            nav.classList.remove("expanded");
            hamburger.classList.remove("active");
            navOverlay.classList.remove("active");
          });
        }

        // Theme toggle
        if (themeToggle && themeIcon) {
          const spinIcon = () => {
            themeIcon.classList.add("spin");
            setTimeout(() => themeIcon.classList.remove("spin"), 500);
          };

          const setTheme = (theme) => {
            spinIcon();
            if (theme === "dark") {
              document.documentElement.classList.add("dark");
              themeIcon.textContent = "ðŸŒ™";
              localStorage.setItem("theme", "dark");
            } else {
              document.documentElement.classList.remove("dark");
              themeIcon.textContent = "â˜€ï¸";
              localStorage.setItem("theme", "light");
            }
          };

          // Initialize theme
          setTheme(localStorage.getItem("theme") || "light");

          themeToggle.addEventListener("click", () => {
            const current = document.documentElement.classList.contains("dark") ? "dark" : "light";
            setTheme(current === "dark" ? "light" : "dark");
          });
        }

        // Active link highlighting
        if (nav) {
          const navLinks = nav.querySelectorAll("a");
          const currentPath = window.location.pathname;
          navLinks.forEach((link) => {
            const linkPath = new URL(link.href).pathname;
            if (linkPath === currentPath) link.classList.add("active");
            else link.classList.remove("active");

            link.addEventListener("click", () => {
              if (nav.classList.contains("expanded")) {
                nav.classList.remove("expanded");
                hamburger?.classList.remove("active");
                navOverlay?.classList.remove("active");
              }
            });
          });
        }
      });
    </script>
  </body>
</html>
